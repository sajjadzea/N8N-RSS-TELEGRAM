# ุฑุงูููุง ุณุฑุน - Air Quality Monitor

ุงู ุฑุงูููุง ุฑุง ุจุฑุง ุฑุงูโุงูุฏุงุฒ ุณุฑุน Workflow ุฏุฑ n8n ุฏูุจุงู ฺฉูุฏ.

## โ ฺฺฉโูุณุช ุฑุงูโุงูุฏุงุฒ (5 ุฏููู)

### ูุฑุญูู 1: Import ฺฉุฑุฏู Workflow
1. ุฏุฑ n8n ุฑู **Workflows** ฺฉูฺฉ ฺฉูุฏ
2. ุฑู **Import from File** ฺฉูฺฉ ฺฉูุฏ
3. ูุงู `Air_Quality_Monitor.json` ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
4. ุฑู **Import** ฺฉูฺฉ ฺฉูุฏ

### ูุฑุญูู 2: ุชูุธู Telegram Bot
1. ุฏุฑ Telegram ุจู ุฑุจุงุช [@BotFather](https://t.me/BotFather) ูพุงู ุฏูุฏ
2. ุฏุณุชูุฑ `/newbot` ุฑุง ุงุฑุณุงู ฺฉูุฏ (ุงฺฏุฑ ูุจูุงู ุฑุจุงุช ูุฏุงุฑุฏ)
3. ุง ุงุฒ ุฑุจุงุช ููุฌูุฏ ุฎูุฏ ุงุณุชูุงุฏู ฺฉูุฏ
4. Access Token ุฑุง ฺฉูพ ฺฉูุฏ (ูุซุงู: `123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11`)

### ูุฑุญูู 3: ุงุถุงูู ฺฉุฑุฏู Credentials ุฏุฑ n8n
1. ุฏุฑ n8n ุจู **Settings โ Credentials** ุจุฑูุฏ
2. ุฑู **New** ฺฉูฺฉ ฺฉูุฏ
3. ููุน: **Telegram API** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
4. ูุงู: `Telegram Bot` (ุง ูุฑ ูุงู ุฏูุฎูุงู)
5. Access Token ุฑุง ูุงุฑุฏ ฺฉูุฏ
6. ุฑู **Create** ฺฉูฺฉ ฺฉูุฏ

### ูุฑุญูู 4: ุชูุธู Environment Variables
1. ุฏุฑ n8n ุจู **Settings โ Variables** (ุง Environments) ุจุฑูุฏ
2. ุฏู ูุชุบุฑ ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:

```
Name: AQMS_BEARER
Value: PD-jvbkAgKdeLFivtcSyxsJxt3WG94u59PMTNWccp9EXI7yO5Zg6ET8I2p0gACOpDbI6jdFVkl2pVZPwhuxZFWTo5W67YK9liE9sAcJWqzK30TmD-XMYKUUgUiXgA1PrytYyTsuTUF72NmZ7RorFLueMJNGrywYuUhAv0XRbLIcFQH123JCvahFzU29HF9SGVu-fAVx68mVzQlwdcfjSfM6CFaLuWdBg6VK5bWKUV837jv7nTESLate0huP7_HVdQ3F8kwR_0_TNdmocePsfb4KaNLl9zgzfoyoE5aSK6JDGJvVZ3Zb6_jEQ5mdVlQbj
```

```
Name: TELEGRAM_CHAT_ID
Value: @your_channel_or_chat_id
```

**ูฺฉุชู**: ุจุฑุง ุฏุฑุงูุช Chat ID:
- ุจุฑุง ฺฉุงูุงู: ูุงู ฺฉุงุฑุจุฑ ฺฉุงูุงู ุจุง @ (ูุซุงู: `@my_channel`)
- ุจุฑุง ฺุช ุฎุตูุต: ุงุฒ ุฑุจุงุช [@userinfobot](https://t.me/userinfobot) ุงุณุชูุงุฏู ฺฉูุฏ

### ูุฑุญูู 5: ุงุชุตุงู Telegram Credential ุจู Node
1. ุฏุฑ Workflow ุฑู node **"Send to Telegram"** ฺฉูฺฉ ฺฉูุฏ
2. ุฏุฑ ูุณูุช **Credential to connect with** ุฑู ุขฺฉูู โ๏ธ ฺฉูฺฉ ฺฉูุฏ
3. Credential **"Telegram Bot"** ฺฉู ุณุงุฎุชุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ

### ูุฑุญูู 6: ุชุณุช ู ูุนุงูโุณุงุฒ
1. ุฑู node **"Every Hour"** ฺฉูฺฉ ุฑุงุณุช ฺฉูุฏ
2. **Execute Node** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
3. ุงฺฏุฑ ุฎุทุง ูุฏุงุดุชุ workflow ุงุฌุฑุง ูโุดูุฏ
4. ูพุงู ุฑุง ุฏุฑ ฺฉุงูุงู ุชูฺฏุฑุงู ุฎูุฏ ฺฺฉ ฺฉูุฏ
5. ุฑู ุฏฺฉูู **Active** ุฏุฑ ุจุงูุง ุตูุญู ฺฉูฺฉ ฺฉูุฏ ุชุง workflow ูุฑ ุณุงุนุช ุงุฌุฑุง ุดูุฏ

---

## ๐ ูฺฉุงุช ููู

### ุดูุงุณู ุงุณุชุงูโูุง (StateId)
ุจุฑุง ุชุบุฑ ุงุณุชุงูุ ุฏุฑ nodeูุง "Get Stations" ู "Get AQI" ูพุงุฑุงูุชุฑ `StateId` ุฑุง ุชุบุฑ ุฏูุฏ:

- ุฎุฑุงุณุงู ุฑุถู: `StateId=8`
- ุชูุฑุงู: `StateId=1`
- ุงุตููุงู: `StateId=3`
- ุงุณุชุงูโูุง ุฏฺฏุฑ: ุงุฒ [API documentation](https://aqms.doe.ir) ฺฺฉ ฺฉูุฏ

### ุงฺฏุฑ ุฎุทุง ุฏุฑุงูุช ฺฉุฑุฏุฏ:

**ุฎุทุง: "Bearer token is invalid"**
โ ุชูฺฉู ูููุถ ุดุฏู. ฺฉ ุชูฺฉู ุฌุฏุฏ ุงุฒ ุณุงุช aqms.doe.ir ุฏุฑุงูุช ฺฉูุฏ.

**ุฎุทุง: "Chat not found"**
โ ุฑุจุงุช ุจู ฺฉุงูุงู ุงุถุงูู ูุดุฏู ุง Chat ID ุงุดุชุจุงู ุงุณุช.

**ุฎุทุง: "Could not reach URL"**
โ ุงุชุตุงู ุงูุชุฑูุช ุฑุง ฺฺฉ ฺฉูุฏ. ููฺฉู ุงุณุช ูุงุฒ ุจู VPN ุจุงุดุฏ.

**ุฎุทุง: "Unauthorized"**
โ Telegram Bot Token ุงุดุชุจุงู ุงุณุช.

### ุชุบุฑ ุฒูุงู ุงุฌุฑุง

ุฏุฑ node "Every Hour":
- ูุฑ 30 ุฏููู: `Minutes interval = 30`
- ูุฑ 2 ุณุงุนุช: `Hours interval = 2`
- ุฑูุฒุงูู ุฏุฑ ุณุงุนุช 8 ุตุจุญ: `Cron Expression = 0 8 * * *`

---

## ๐ฑ ููููู ุฎุฑูุฌ

ุจุนุฏ ุงุฒ ุงุฌุฑุง ููููุ ุงู ูพุงู ุฏุฑ ุชูฺฏุฑุงู ุงุฑุณุงู ูโุดูุฏ:

```
*ุดุงุฎุต ฺฉูุช ููุง โ ุฎูุงุตู (ุฎุฑุงุณุงู ุฑุถู)*
ุฒูุงู ุจุฑูุฒุฑุณุงู: ฑดฐด/ฐท/ณฐ ฐน:ฐฐ
ุชุนุฏุงุฏ ุงุณุชฺฏุงูโูุง: ฒด

*ูพูุฌ ุงุณุชฺฏุงู ุจุง ุจุฏุชุฑู ูุถุนุช (AQI):*
1. *ูุดูุฏ - ุฑุณุงูุช* โ ุดุงุฎุต: *ฑธด* โ ุขูุงูุฏูโ ุบุงูุจ: PM10
2. *ูุดูุฏ - ุณุฌุงุฏ* โ ุดุงุฎุต: *ฑถท* โ ุขูุงูุฏูโ ุบุงูุจ: PM2.5
3. *ูุดูุฏ - ฺฉููุณูฺฏ* โ ุดุงุฎุต: *ฑตฒ*
4. *ูุดูุฏ - ูฺฉูโุขุจุงุฏ* โ ุดุงุฎุต: *ฑดต*
5. *ูุดุงุจูุฑ* โ ุดุงุฎุต: *ฑฒณ*

_ูพุงู ุฎูุฏฺฉุงุฑ โ ูุฑ ุณุงุนุช ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ._
```

---

## ๐ ุจูโุฑูุฒุฑุณุงู ุชูฺฉู

ููุช ุชูฺฉู ูููุถ ุดุฏ:

1. ุจู [https://aqms.doe.ir](https://aqms.doe.ir) ุจุฑูุฏ
2. DevTools (F12) โ Network ุฑุง ุจุงุฒ ฺฉูุฏ
3. ฺฉ ุฏุฑุฎูุงุณุช API ุฑุง ูุดุงูุฏู ฺฉูุฏ
4. ุงุฒ Headers ููุฏุงุฑ `Authorization: Bearer ...` ุฑุง ฺฉูพ ฺฉูุฏ
5. ุฏุฑ n8n Settings โ Variables ููุฏุงุฑ `AQMS_BEARER` ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ

---

## ๐ ูุณุชูุฏุงุช ฺฉุงูู

ุจุฑุง ุฌุฒุฆุงุช ุจุดุชุฑุ ูุงู [Air_Quality_Monitor_README.md](./Air_Quality_Monitor_README.md) ุฑุง ูุทุงูุนู ฺฉูุฏ.

---

**โจ ูููู ุจุงุดุฏ!**
