# ๐ Workflow ุงุณุชุฎุฑุงุฌ ฺุงูุดโูุง ููุขูุฑ NAN - ุฎุฑุงุณุงู ุฑุถู

ุงู workflow ุจุฑุง ุงุณุชุฎุฑุงุฌ ุฎูุฏฺฉุงุฑ ฺุงูุดโูุง ููุขูุฑ ูุฑุจูุท ุจู ุงุณุชุงู ุฎุฑุงุณุงู ุฑุถู ุงุฒ ุณุงุช [nan.ac](https://nan.ac/challenges) ุทุฑุงุญ ุดุฏู ุงุณุช.

## ๐ฏ ูุงุจูุชโูุง

- โ ุงุณุชุฎุฑุงุฌ ุฎูุฏฺฉุงุฑ ฺุงูุดโูุง ุงุฒ ุณุงุช NAN
- โ ููุชุฑ ฺฉุฑุฏู ฺุงูุดโูุง ุฎุฑุงุณุงู ุฑุถู
- โ ุชุดุฎุต ููุดููุฏ ุชุบุฑุงุช (ฺุงูุดโูุง ุฌุฏุฏ ู ุจูโุฑูุฒุฑุณุงูโูุง)
- โ ุงุฑุณุงู ุฎูุฏฺฉุงุฑ ุจู ุชูฺฏุฑุงู
- โ ุงุฌุฑุง ุฏูุฑูโุง ูุฑ 12 ุณุงุนุช

## โ๏ธ ูุญูู ุฑุงูโุงูุฏุงุฒ

### ูุฑุญูู 1๏ธโฃ: ุจุฑุฑุณ ุณุงุฎุชุงุฑ ุณุงุช

ูุจู ุงุฒ ุงุณุชูุงุฏูุ **ุญุชูุงู** ุจุงุฏ ุณุงุฎุชุงุฑ ุณุงุช ุฑู ุจุฑุฑุณ ฺฉู ู ฺฉุฏ ูพุงุฑุณุฑ ุฑู ุชูุธู ฺฉู:

#### ุฑูุด ุจุฑุฑุณ:

1. **ุจุงุฒ ฺฉุฑุฏู Developer Tools:**
   - ุณุงุช [https://nan.ac/challenges](https://nan.ac/challenges) ุฑู ุจุงุฒ ฺฉู
   - ฺฉูุฏ `F12` ุฑู ุจุฒู (ุง ฺฉูฺฉ ุฑุงุณุช โ Inspect)

2. **ุจุฑุฑุณ Network Requests:**
   - ุจู ุชุจ **Network** ุจุฑู
   - ุตูุญู ุฑู Refresh ฺฉู (`Ctrl+R`)
   - ุฏูุจุงู ุฏุฑุฎูุงุณุชโูุง API ุจฺฏุฑุฏ:
     - ฺุฒ ุดุจู `/api/challenges`
     - ุง `challenges.json`
     - ุง `data.json`

3. **ุงฺฏุฑ API ูพุฏุง ฺฉุฑุฏ:**
   ```
   โ ุจูุชุฑู ุญุงูุช!
   - URL ุฑู ุงุฏุฏุงุดุช ฺฉู
   - Response ุฑู ุจุจู (JSON ุง HTMLุ)
   - ุณุงุฎุชุงุฑ ุฏุงุฏูโูุง ุฑู ุจุฑุฑุณ ฺฉู
   ```

4. **ุงฺฏุฑ API ูุจูุฏุ ุจุฑุฑุณ HTML:**
   - ุจู ุชุจ **Elements** ุจุฑู
   - ุฏูุจุงู ฺฉุงุฑุชโูุง ุง ูุณุช ฺุงูุดโูุง ุจฺฏุฑุฏ
   - ุจุจู ฺุงูุดโูุง ุฎุฑุงุณุงู ุฑุถู ฺู `class` ุง `id` ุฏุงุฑู
   - ุณุงุฎุชุงุฑ HTML ุฑู ุงุฏุฏุงุดุช ฺฉู

#### ูุซุงู ุณุงุฎุชุงุฑโูุง ููฺฉู:

**ุญุงูุช 1: ุฏุงุฏู ุฏุฑ JSON ุฏุงุฎู ุตูุญู**
```html
<script>
  var challenges = [
    {
      "title": "ฺุงูุด ููููู",
      "province": "ุฎุฑุงุณุงู ุฑุถู",
      "deadline": "1403/09/01"
    }
  ];
</script>
```

**ุญุงูุช 2: ฺฉุงุฑุชโูุง HTML**
```html
<div class="challenge-card" data-province="ุฎุฑุงุณุงู ุฑุถู">
  <h3>ุนููุงู ฺุงูุด</h3>
  <p>ุชูุถุญุงุช...</p>
  <span class="deadline">1403/09/01</span>
</div>
```

**ุญุงูุช 3: API ุฌุฏุงฺฏุงูู**
```
GET https://nan.ac/api/challenges
Response: [{"id": 1, "title": "...", "province": "..."}]
```

### ูุฑุญูู 2๏ธโฃ: ุชูุธู Workflow

ุจุนุฏ ุงุฒ ุจุฑุฑุณ ุณุงุฎุชุงุฑ:

1. **Import ฺฉุฑุฏู Workflow:**
   - ูุงู `NAN_Challenges_Scraper_Khorasan.json` ุฑู ุจุงุฒ ฺฉู
   - ูุญุชูุง ุฑู ฺฉูพ ฺฉู
   - ุฏุฑ n8n: Workflows โ Import

2. **ุชูุธู HTTP Request Node:**

   **ุงฺฏุฑ ุณุงุช API ุฏุงุฑู:**
   - Node "Fetch NAN Challenges Page" ุฑู ุจุงุฒ ฺฉู
   - URL ุฑู ุจู ุขุฏุฑุณ API ุชุบุฑ ุจุฏู
   - `responseFormat` ุฑู ุฑู `json` ุจุฐุงุฑ (ุงฺฏู JSON ุจุฑูโฺฏุฑุฏููู)

   **ุงฺฏู API ูุฏุงุฑู:**
   - ูููู URL ูุนู ุฑู ูฺฏู ุฏุงุฑ
   - ูู ููฺฉูู ูุงุฒ ุจุงุดู Headers ุจุดุชุฑ ุงุถุงูู ฺฉู

3. **ุชูุธู Parser Code:**

   Node "Parse & Filter Khorasan Challenges" ุฑู ุจุงุฒ ฺฉู ู ฺฉุฏ ุฑู ุจุง ุณุงุฎุชุงุฑ ูุงูุน ุณุงุช ุชูุธู ฺฉู:

   **ููููู ุจุฑุง JSON API:**
   ```javascript
   const data = $input.item.json;
   const allChallenges = data.challenges || data.data || [];

   const challenges = allChallenges
     .filter(c => {
       const province = c.province || c.ุงุณุชุงู || '';
       return province.includes('ุฎุฑุงุณุงู ุฑุถู') ||
              province.includes('ูุดูุฏ');
     })
     .map(c => ({
       title: c.title || c.ุนููุงู || '',
       description: c.description || c.ุชูุถุญุงุช || '',
       province: c.province || 'ุฎุฑุงุณุงู ุฑุถู',
       deadline: c.deadline || c.ูููุช || '',
       link: c.link || `https://nan.ac/challenges/${c.id}`,
       organization: c.organization || c.ุณุงุฒูุงู || ''
     }));

   return [{ json: { success: true, challenges, count: challenges.length }}];
   ```

   **ููููู ุจุฑุง HTML Parsing:**
   ```javascript
   const html = $input.item.json;
   const htmlContent = typeof html === 'string' ? html : html.data || '';

   const challenges = [];

   // ูุซุงู: ุงุณุชุฎุฑุงุฌ ุงุฒ div ูุง challenge-card
   const regex = /<div class="challenge-card"[^>]*data-province="ุฎุฑุงุณุงู ุฑุถู"[^>]*>(.*?)<\\/div>/gis;
   const matches = htmlContent.match(regex) || [];

   matches.forEach(card => {
     const titleMatch = card.match(/<h3[^>]*>(.*?)<\\/h3>/i);
     const descMatch = card.match(/<p class="description">(.*?)<\\/p>/i);

     if (titleMatch) {
       challenges.push({
         title: titleMatch[1].replace(/<[^>]+>/g, '').trim(),
         description: descMatch ? descMatch[1].replace(/<[^>]+>/g, '').trim() : '',
         province: 'ุฎุฑุงุณุงู ุฑุถู',
         // ... ุจูู ููุฏูุง
       });
     }
   });

   return [{ json: { success: true, challenges, count: challenges.length }}];
   ```

4. **ุชูุธู Telegram:**
   - Node "Send to Telegram" ุฑู ุจุงุฒ ฺฉู
   - Chat ID ฺฉุงูุงู ุฑู ูุงุฑุฏ ฺฉู (ุจุง `-` ุฏุฑ ุงุจุชุฏุง)
   - Credential ุชูฺฏุฑุงู ุฑู ุงูุชุฎุงุจ ฺฉู

### ูุฑุญูู 3๏ธโฃ: ุชุณุช ู Debug

1. **ุงุฌุฑุง ุฏุณุช:**
   - ุฑู node "Every 12 Hours" ฺฉูฺฉ ุฑุงุณุช ฺฉู
   - "Execute Node" ุฑู ุจุฒู

2. **ุจุฑุฑุณ ุฎุฑูุฌ Parser:**
   - ุฑู node "Parse & Filter Khorasan Challenges" ฺฉูฺฉ ฺฉู
   - ุฎุฑูุฌ ุฑู ุจุจู:
     - ุงฺฏู `challenges` ุฎุงู ุจูุฏ โ ฺฉุฏ ูพุงุฑุณุฑ ุงุดุชุจุงูู
     - ุงฺฏู `rawHtmlLength` ุจุฒุฑฺฏ ุจูุฏ โ HTML ุฏุฑุงูุช ุดุฏูุ ุจุงุฏ parse ุจุดู
     - ุงฺฏู ุฏุงุฏู ุฏุงุดุช โ ุนุงูู! โ

3. **Debug ฺฉุฑุฏู:**

   **ุงฺฏู ุฏุงุฏู ุงุณุชุฎุฑุงุฌ ูุดุฏ:**
   - ุฏุฑ Code node ุงู ุฑู ุงุถุงูู ฺฉู ุจุฑุง ุฏุฏู ูุญุชูุง:
   ```javascript
   // ุฏุฑ ุงุจุชุฏุง ฺฉุฏ ุงุถุงูู ฺฉู
   console.log('HTML Length:', htmlContent.length);
   console.log('First 500 chars:', htmlContent.substring(0, 500));
   ```
   - Execution Log ุฑู ฺฺฉ ฺฉู

   **ุงฺฏู 403 ฺฏุฑูุช:**
   - Headers ุจุดุชุฑ ุงุถุงูู ฺฉู
   - ุง ุงุฒ ุฑูุด API ุงุณุชูุงุฏู ฺฉู

### ูุฑุญูู 4๏ธโฃ: ูุนุงูโุณุงุฒ

- ุฑู "Active" ฺฉูฺฉ ฺฉู
- ูุฑ 12 ุณุงุนุช ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุงุฌุฑุง ูโุดู

## ๐จ ูุฑูุช ูพุงูโูุง

### ูพุงู ุฎูุงุตู:
```
๐ ฺุงูุดโูุง ููุขูุฑ โ ุฎุฑุงุณุงู ุฑุถู

๐ ฺุงูุดโูุง ุฌุฏุฏ: ณ
๐ ฺุงูุดโูุง ุจูโุฑูุฒุฑุณุงู ุดุฏู: ฑ

๐ ุฒูุงู ุจุฑุฑุณ: ฑดฐณ/ฐธ/ฑฐ
```

### ูพุงู ฺุงูุด ุฌุฏุฏ:
```
๐ ฺุงูุด ููุขูุฑ ุฌุฏุฏ

๐ ุนููุงู:
[ุนููุงู ฺุงูุด]

๐ข ุณุงุฒูุงู:
[ูุงู ุณุงุฒูุงู]

๐ท ุฏุณุชูโุจูุฏ:
[ุฏุณุชู]

๐ ุชูุถุญุงุช:
[ุดุฑุญ ฺุงูุด]

โฐ ูููุช:
[ุชุงุฑุฎ]

๐ ุงุณุชุงู: ุฎุฑุงุณุงู ุฑุถู

๐ ูุดุงูุฏู ุฌุฒุฆุงุช
```

## ๐ง ุณูุงุฑุดโุณุงุฒ

### ุชุบุฑ ุงุณุชุงู

ุจุฑุง ุงุณุชุฎุฑุงุฌ ฺุงูุดโูุง ุงุณุชุงู ุฏฺฏุฑ:

1. ุฏุฑ node "Parse & Filter Khorasan Challenges":
   ```javascript
   // ุฎุท ุฒุฑ ุฑู ูพุฏุง ฺฉู:
   if (province.includes('ุฎุฑุงุณุงู ุฑุถู') || ...)

   // ุชุบุฑ ุจุฏู ุจู:
   if (province.includes('ุชูุฑุงู') || ...)
   ```

2. ุฏุฑ node "Format Telegram Messages":
   ```javascript
   // ุฎุท ุฒุฑ ุฑู ูพุฏุง ฺฉู:
   msg += `*๐ ุงุณุชุงู:* ุฎุฑุงุณุงู ุฑุถู\\n\\n`;

   // ุชุบุฑ ุจุฏู ุจู ุงุณุชุงู ููุฑุฏ ูุธุฑ
   ```

3. ูุงู workflow ุฑู ุนูุถ ฺฉู

### ุงูุฒูุฏู ููุชุฑูุง ุจุดุชุฑ

ูโุชูู ุจุฑ ุงุณุงุณ ุฏุณุชูโุจูุฏ ุง ุณุงุฒูุงู ูู ููุชุฑ ฺฉู:

```javascript
const challenges = allChallenges
  .filter(c => {
    const province = c.province || '';
    const category = c.category || '';

    return (province.includes('ุฎุฑุงุณุงู ุฑุถู')) &&
           (category.includes('ููุงูุฑ ุงุทูุงุนุงุช'));
  });
```

## โ๏ธ ูฺฉุงุช ููู

1. **ุณุงุฎุชุงุฑ ุณุงุช ููฺฉูู ุชุบุฑ ฺฉูู**
   - ูุฑ ุงุฒ ฺฏุงู workflow ุฑู ฺฺฉ ฺฉู
   - ุงฺฏู ุฏุงุฏู ูููุฏุ ุณุงุฎุชุงุฑ ุณุงุช ุฑู ุฏูุจุงุฑู ุจุฑุฑุณ ฺฉู

2. **ูุญุฏูุฏุช Rate Limiting**
   - ุงฺฏู ุฏุฑุฎูุงุณุชโูุง ุฒุงุฏ ุฒุฏ ู ban ุดุฏุ ูุงุตูู ุฒูุงู ุฑู ุฒุงุฏ ฺฉู
   - ุงุฒ 12 ุณุงุนุช ุจู 24 ุณุงุนุช ุชุบุฑ ุจุฏู

3. **ุฏุงุฏูโูุง ุฐุฎุฑู ุดุฏู**
   - ุจุฑุง reset: workflow ุฑู ุบุฑูุนุงู ู ุฏูุจุงุฑู ูุนุงู ฺฉู

## ๐ ุนุจโุงุจ

### ุฏุงุฏู ุงุณุชุฎุฑุงุฌ ููโุดู
1. โ Developer Tools ุฑู ุจุงุฒ ฺฉู ู ุณุงุฎุชุงุฑ ุณุงุช ุฑู ุจุจู
2. โ ฺฉุฏ parser ุฑู ุจุง ุณุงุฎุชุงุฑ ูุงูุน ุชุทุจู ุจุฏู
3. โ ุงฺฏู ุณุงุช ุงุฒ JavaScript ุงุณุชูุงุฏู ูโฺฉููุ ููฺฉูู ูุงุฒ ุจู Puppeteer ุจุงุดู

### ุฎุทุง 403
1. โ Headers ุจุดุชุฑ ุงุถุงูู ฺฉู
2. โ ุงุฒ API ุงุณุชูุงุฏู ฺฉู (ุงฺฏู ุฏุงุฑู)
3. โ User-Agent ุฑู ุชุบุฑ ุจุฏู

### ูฺ ฺุงูุด ุจุฑุง ุฎุฑุงุณุงู ุฑุถู ูุณุช
1. โ ูุทูุฆู ุดู ุณุงุช ูุงูุนุงู ฺุงูุด ุฏุงุฑู
2. โ ููุชุฑ province ุฑู ฺฺฉ ฺฉู
3. โ ุจุจู ุณุงุช ฺู ูุงู ุจุฑุง ุงุณุชุงู ุงุณุชูุงุฏู ูโฺฉูู

## ๐ ููุงุจุน

- [ูุณุชูุฏุงุช n8n](https://docs.n8n.io)
- [HTML Parsing ุจุง Regex](https://regex101.com)
- [Telegram Bot API](https://core.telegram.org/bots/api)

## ๐ค ฺฉูฺฉ

ุงฺฏู ูุดฺฉู ุฏุงุดุช:
1. Execution log ุฑู ฺฺฉ ฺฉู
2. ุฎุฑูุฌ ูุฑ node ุฑู ุจุจู
3. ุณุงุฎุชุงุฑ ูุงูุน ุณุงุช ุฑู ุจุง ฺฉุฏ ููุงุณู ฺฉู

---

**ูฺฉุชู ููู:** ุงู workflow ู template ฺฉู ูุณุช. **ุญุชูุงู** ุจุงุฏ ฺฉุฏ parser ุฑู ุจุง ุณุงุฎุชุงุฑ ูุงูุน ุณุงุช ุชูุธู ฺฉู! ๐ง
